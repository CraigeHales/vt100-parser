#!/usr/bin/env python

import sys, os

EXT = '.html'


BOLD      = 1
UNDERLINE = 2
BLINK     = 4
INVERSE   = 8
FG        = 0xf0
FG_SET    = 0x80
BG        = 0xf00
BG_SET    = 0x800
BLACK     = 0
RED       = 1
GREEN     = 2
YELLOW    = 3
BLUE      = 4
MAGENTA   = 5
CYAN      = 6
WHITE     = 7
FG_BLACK   = 0x80
FG_RED     = 0x90
FG_GREEN   = 0xa0
FG_YELLOW  = 0xb0
FG_BLUE    = 0xc0
FG_MAGENTA = 0xd0
FG_CYAN    = 0xe0
FG_WHITE   = 0xf0
BG_BLACK   = 0x800
BG_RED     = 0x900
BG_GREEN   = 0xa00
BG_YELLOW  = 0xb00
BG_BLUE    = 0xc00
BG_MAGENTA = 0xd00
BG_CYAN    = 0xe00
BG_WHITE   = 0xf00


class Character (object):
    def __init__(self, character, properties):
        self.character = character
        self.properties = properties
    def __str__(self):
        # TODO
        self.character


class Screen (object):
    def __init__(self):
        self.pos = [0,0]
        self.current_properties = None
    def add(self, character):
        for c in s:
            if c != '\033':
                self.append(c)

    def output(self):
        raise NotImplementedError()


def vt100_to_html(s):
    return Screen(s).output()


def process(infilename, outfilename = None):
    if outfilename is None:
        if infilename == '-':
            outfilename = '-'
        else:
            outfilename = infilename + EXT

    # Slurp the input
    if infilename == '-':
        infile = sys.stdin
    else:
        infile = open(infilename, 'rb')
    input = infile.read()
    if infile is not sys.stdin:
        infile.close()

    output = vt100_to_html(input)

    # Write all the output
    if outfilename == '-':
        outfile = sys.stdout
    else:
        outfile = open(outfilename, 'wb')
    outfile.write(output)
    if outfile is not sys.stdout:
        outfile.close()


def main(argv):
    if argv:
        for filename in sys.argv[1:]:
            main(filename)
    else:
        main('-')

if __name__ == "__main__":
    main(sys.argv[1:])
